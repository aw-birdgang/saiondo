@startuml
actor UserApp as 사용자

participant Controller as "API Controller\n(Presentation Layer)"
participant Service as "UseCase / Service\n(Application Layer)"
participant Domain as "Domain Model"
participant Repository as "Database Repository\n(Infrastructure Layer)"
participant ExternalAPI as "External API Client\n(Infrastructure Layer)"
participant LLMProxy as "LLM Proxy\n(Infrastructure Layer)"

사용자 -> Controller : 1️⃣ HTTP 요청 (ex: POST /relationship-coach)
Controller -> Service : 2️⃣ 요청 처리 위임 (DTO 전달)

Service -> Domain : 3️⃣ 도메인 모델/로직 활용
Service -> Repository : 4️⃣ DB 조회/저장
Service -> ExternalAPI : 5️⃣ 외부 API 호출 (선택)
Service -> LLMProxy : 6️⃣ LLM 프록시 호출 (선택)

LLMProxy --> Service : 7️⃣ LLM 응답 (JSON 형태)
ExternalAPI --> Service : 8️⃣ 외부 API 응답
Repository --> Service : 9️⃣ DB 결과 반환

Service --> Controller : 10️⃣ 최종 응답 데이터
Controller --> 사용자 : 11️⃣ HTTP 응답 반환

@enduml
