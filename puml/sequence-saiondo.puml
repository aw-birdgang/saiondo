@startuml
title Saiondo: 프롬프트 입력 ~ LLM 분석 ~ 결과 반환

actor User
participant "Flutter App" as App
participant "NestJS API" as API
participant "LLM Proxy (NestJS)" as Proxy
participant "FastAPI + LangChain" as LLM
database "PostgreSQL" as DB

User -> App : 프롬프트 입력
App -> API : POST /chat (프롬프트, userId, roomId)
API -> DB : chat-histories에 사용자 메시지 저장
API -> Proxy : LLM 분석 요청 (프롬프트, roomId)
Proxy -> LLM : POST /chat (프롬프트, 모델)
LLM -> LLM : LLM 분석 (OpenAI/Claude)
LLM --> Proxy : 분석 결과/피드백 반환
Proxy --> API : LLM 결과 반환
API -> DB : chat-histories에 LLM 피드백 저장
API --> App : 사용자 메시지 + LLM 피드백 반환
App --> User : 결과 표시

@enduml
