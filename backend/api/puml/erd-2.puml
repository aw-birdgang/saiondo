@startuml
skinparam class {
  BackgroundColor White
  ArrowColor Black
  BorderColor Black
  RoundCorner 10
}

' 엔티티 정의
entity "User" as User {
  * id : String
  --
  name : String
  email : String
  password : String
  birthDate : DateTime
  gender : Gender
  isSubscribed : Boolean
  subscriptionUntil : DateTime
}

entity "UserProfile" as UserProfile {
  * id : String
  --
  userId : String
  fmToken : String
  point : Int
}

entity "Wallet" {
  * id : String
  --
  userId : String
  address : String
  privateKey : String
  mnemonic : String
  tokenBalance : String
  derivationIndex : Int
}

entity "Channel" {
  * id : String
  --
  inviteCode : String
  status : String
  startedAt : DateTime
  endedAt : DateTime
  anniversary : DateTime
  keywords : String
}

entity "ChannelMember" {
  * id : String
  --
  channelId : String
  userId : String
  role : String
  joinedAt : DateTime
}

entity "Assistant" {
  * id : String
  --
  userId : String
  channelId : String
}

entity "PersonaProfile" {
  * id : String
  --
  userId : String
  content : String
  isStatic : Boolean
  confidenceScore : Float
}

entity "ProfileCategory" {
  * id : String
  --
  name : String
  description : String
}

entity "PersonaProfileCategory" {
  * id : String
  --
  profileId : String
  categoryId : String
}

entity "ChatMessage" {
  * id : String
  --
  channelId : String
  senderId : String
  assistantId : String
  message : String
  type : String
  createdAt : DateTime
}

entity "CoupleAnalysis" {
  * id : String
  --
  channelId : String
  rawResult : String
  generatedAt : DateTime
}

entity "PushSchedule" {
  * id : String
  --
  userId : String
  scheduledAt : DateTime
  sentAt : DateTime
  status : PushStatus
}

entity "UserAnswer" {
  * id : String
  --
  pushScheduleId : String
  answerText : String
  createdAt : DateTime
}

entity "Advice" {
  * id : String
  --
  channelId : String
  advice : String
  generatedById : String
}

' 관계 설정
User --> UserProfile : has
User --> Wallet : owns
User --> ChannelMember : joins
User --> Assistant : is
User --> PersonaProfile : writes
User --> PushSchedule : receives
Channel --> ChannelMember : includes
Channel --> Assistant : has
Channel --> ChatMessage : contains
Channel --> CoupleAnalysis : generates
Channel --> Advice : has
PersonaProfile --> PersonaProfileCategory
PersonaProfileCategory --> ProfileCategory
PushSchedule --> UserAnswer : triggers
ChatMessage --> Assistant : sentBy
@enduml
