@startuml
!theme plain
skinparam componentStyle uml2
skinparam shadowing false
skinparam roundcorner 15
skinparam monochrome true
skinparam backgroundColor #F9F9F9
skinparam ArrowColor Black
skinparam ArrowFontColor Black
skinparam defaultFontName "Nanum Gothic"

skinparam package {
  BackgroundColor #E3F2FD
  BorderColor #1976D2
  FontColor #0D47A1
  FontSize 14
  FontStyle bold
}

skinparam component {
  BackgroundColor #F3E5F5
  BorderColor #7B1FA2
  FontColor #4A148C
  FontSize 12
  FontStyle bold
}

skinparam database {
  BackgroundColor #E8F5E8
  BorderColor #388E3C
  FontColor #1B5E20
  FontSize 12
  FontStyle bold
}

skinparam arrow {
  Color #424242
  FontColor #424242
  FontSize 11
  FontStyle italic
}

skinparam note {
  BackgroundColor #FFF3E0
  BorderColor #F57C00
  FontColor #E65100
  FontSize 10
}

title <color:#1976D2><size:18><b>Push Notification Service</b></size></color>\n<color:#666666><size:12>Component Diagram (NestJS + Flutter + Firebase)</size></color>

package "ğŸ“± Client" {
  [Flutter App] as Flutter
}

package "âš™ï¸ Backend (NestJS)" {
  [NestJS Server] as Server
  [PushController] as Controller
  [FirebaseService] as Service
  [Firebase Admin SDK] as AdminSDK
}

package "â˜ï¸ Firebase Cloud" {
  [FCM] as FCM
}

database "ğŸ—„ï¸ Database" as DB {
  [PostgreSQL] as PG
}

' Flutter ì•±ì´ FCM í† í°ì„ ìš”ì²­
Flutter -[#4CAF50,thickness=2]-> FCM : ğŸ”‘ Token Request

' Flutter ì•±ì´ ì„œë²„ì— FCM í† í°/ë©”ì‹œì§€ ì „ì†¡ ìš”ì²­
Flutter -[#2196F3,thickness=2]-> Server : POST /push/send

' ì„œë²„ì˜ ë‚´ë¶€ íë¦„
Server -[#9C27B0,thickness=1]-> Controller
Controller -[#9C27B0,thickness=1]-> Service
Service -[#9C27B0,thickness=1]-> AdminSDK
Controller -[#FF9800,thickness=1]-> PG : ğŸ’¾ Save FCM Token\n<color:#666666><i>(Optional)</i></color>

' ì„œë²„ê°€ FCMì— í‘¸ì‹œ ì „ì†¡
AdminSDK -[#F44336,thickness=2]-> FCM : ğŸ“¢ Send Push

' FCMì´ Flutter ì•±ì— í‘¸ì‹œ ì „ë‹¬
FCM -[#4CAF50,thickness=2]-> Flutter : ğŸ“± Deliver Notification

note right of Flutter
  <b>Flutter App</b>
  â€¢ FCM í† í° ê´€ë¦¬
  â€¢ í‘¸ì‹œ ìˆ˜ì‹  ì²˜ë¦¬
  â€¢ í† í° ê°±ì‹ 
end note

note right of Controller
  <b>PushController</b>
  â€¢ í‘¸ì‹œ ì „ì†¡ API
  â€¢ í† í° ì €ì¥/ê´€ë¦¬
  â€¢ ìœ íš¨ì„± ê²€ì¦
end note

note right of Service
  <b>FirebaseService</b>
  â€¢ FCM í™˜ê²½ ê²€ì¦
  â€¢ ë©”ì‹œì§€ í¬ë§·íŒ…
  â€¢ ì—ëŸ¬ ì²˜ë¦¬
end note

note right of FCM
  <b>Firebase Cloud Messaging</b>
  â€¢ í‘¸ì‹œ ì „ì†¡ ì„œë¹„ìŠ¤
  â€¢ í† í° ê´€ë¦¬
  â€¢ ì „ì†¡ ìƒíƒœ ì¶”ì 
end note

@enduml
